<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - MMO Services Store</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        .sidebar {
            width: 250px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar h2 {
            margin-bottom: 30px;
            text-align: center;
            font-size: 20px;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-menu li {
            margin-bottom: 10px;
        }

        .nav-menu a {
            display: block;
            padding: 12px 15px;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .nav-menu a:hover,
        .nav-menu a.active {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 30px;
        }

        .header {
            background: white;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .header h1 {
            color: #333;
            font-size: 28px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .stat-card .icon {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .stat-card .number {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-card .label {
            color: #666;
            font-size: 14px;
        }

        .content-section {
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 30px;
            margin-bottom: 30px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .section-header h2 {
            color: #333;
            font-size: 24px;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success {
            background: #4CAF50;
            color: white;
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .btn-warning {
            background: #ff9800;
            color: white;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        .table tr:hover {
            background: #f8f9fa;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }

        .form-group textarea {
            height: 100px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close {
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #aaa;
        }

        .close:hover {
            color: #000;
        }

        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-success {
            background: #d4edda;
            color: #155724;
        }

        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }

        .badge-danger {
            background: #f8d7da;
            color: #721c24;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 100%;
                position: relative;
                height: auto;
            }

            .main-content {
                margin-left: 0;
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <h2>üõ†Ô∏è Admin Panel</h2>
            <ul class="nav-menu">
                <li><a href="#dashboard" class="active" onclick="showSection('dashboard')">üìä Dashboard</a></li>
                <li><a href="#categories" onclick="showSection('categories')">üìÅ Danh M·ª•c</a></li>
                <li><a href="#products" onclick="showSection('products')">üì¶ S·∫£n Ph·∫©m</a></li>
                <li><a href="#orders" onclick="showSection('orders')">üõí ƒê∆°n H√†ng</a></li>
                <li><a href="#settings" onclick="showSection('settings')">‚öôÔ∏è C√†i ƒê·∫∑t</a></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Section -->
            <div id="dashboard-section" class="content-section">
                <div class="header">
                    <h1>üìä Dashboard</h1>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="icon">üì¶</div>
                        <div class="number" id="total-products">0</div>
                        <div class="label">T·ªïng S·∫£n Ph·∫©m</div>
                    </div>
                    <div class="stat-card">
                        <div class="icon">üìÅ</div>
                        <div class="number" id="total-categories">0</div>
                        <div class="label">Danh M·ª•c</div>
                    </div>
                    <div class="stat-card">
                        <div class="icon">üõí</div>
                        <div class="number" id="total-orders">0</div>
                        <div class="label">ƒê∆°n H√†ng</div>
                    </div>
                    <div class="stat-card">
                        <div class="icon">üí∞</div>
                        <div class="number" id="total-revenue">0‚Ç´</div>
                        <div class="label">Doanh Thu</div>
                    </div>
                </div>
            </div>

            <!-- Categories Section -->
            <div id="categories-section" class="content-section" style="display: none;">
                <div class="section-header">
                    <h2>üìÅ Qu·∫£n L√Ω Danh M·ª•c</h2>
                    <button class="btn btn-primary" onclick="openCategoryModal()">‚ûï Th√™m Danh M·ª•c</button>
                </div>
                <table class="table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>T√™n Danh M·ª•c</th>
                            <th>M√¥ T·∫£</th>
                            <th>S·ªë S·∫£n Ph·∫©m</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="categories-table">
                        <!-- Categories will be loaded here -->
                    </tbody>
                </table>
            </div>

            <!-- Products Section -->
            <div id="products-section" class="content-section" style="display: none;">
                <div class="section-header">
                    <h2>üì¶ Qu·∫£n L√Ω S·∫£n Ph·∫©m</h2>
                    <button class="btn btn-primary" onclick="openProductModal()">‚ûï Th√™m S·∫£n Ph·∫©m</button>
                </div>
                <table class="table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>T√™n S·∫£n Ph·∫©m</th>
                            <th>Danh M·ª•c</th>
                            <th>Gi√°</th>
                            <th>T·ªìn Kho</th>
                            <th>Tr·∫°ng Th√°i</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="products-table">
                        <!-- Products will be loaded here -->
                    </tbody>
                </table>
            </div>

            <!-- Orders Section -->
            <div id="orders-section" class="content-section" style="display: none;">
                <div class="section-header">
                    <h2>üõí Qu·∫£n L√Ω ƒê∆°n H√†ng</h2>
                </div>
                <table class="table">
                    <thead>
                        <tr>
                            <th>M√£ ƒê∆°n</th>
                            <th>Kh√°ch H√†ng</th>
                            <th>S·∫£n Ph·∫©m</th>
                            <th>T·ªïng Ti·ªÅn</th>
                            <th>Tr·∫°ng Th√°i</th>
                            <th>Ng√†y T·∫°o</th>
                            <th>Thao T√°c</th>
                        </tr>
                    </thead>
                    <tbody id="orders-table">
                        <!-- Orders will be loaded here -->
                    </tbody>
                </table>
            </div>

            <!-- Settings Section -->
            <div id="settings-section" class="content-section" style="display: none;">
                <div class="section-header">
                    <h2>‚öôÔ∏è C√†i ƒê·∫∑t H·ªá Th·ªëng</h2>
                </div>
                <div class="form-group">
                    <label>T√™n Website:</label>
                    <input type="text" id="site-name" placeholder="T√™n website">
                </div>
                <div class="form-group">
                    <label>M√¥ T·∫£ Website:</label>
                    <textarea id="site-description" placeholder="M√¥ t·∫£ website"></textarea>
                </div>
                <div class="form-group">
                    <label>Email Li√™n H·ªá:</label>
                    <input type="email" id="contact-email" placeholder="admin@andev.site">
                </div>
                <div class="form-group">
                    <label>S·ªë ƒêi·ªán Tho·∫°i:</label>
                    <input type="tel" id="contact-phone" placeholder="0123456789">
                </div>
                <button class="btn btn-primary" onclick="saveSettings()">üíæ L∆∞u C√†i ƒê·∫∑t</button>
            </div>
        </div>
    </div>

    <!-- Category Modal -->
    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìÅ Th√™m/S·ª≠a Danh M·ª•c</h3>
                <span class="close" onclick="closeCategoryModal()">&times;</span>
            </div>
            <form id="categoryForm">
                <div class="form-group">
                    <label>T√™n Danh M·ª•c:</label>
                    <input type="text" id="category-name" required>
                </div>
                <div class="form-group">
                    <label>M√¥ T·∫£:</label>
                    <textarea id="category-description"></textarea>
                </div>
                <div class="form-group">
                    <label>Icon:</label>
                    <input type="text" id="category-icon" placeholder="ü§ñ">
                </div>
                <button type="submit" class="btn btn-primary">üíæ L∆∞u Danh M·ª•c</button>
            </form>
        </div>
    </div>

    <!-- Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üì¶ Th√™m/S·ª≠a S·∫£n Ph·∫©m</h3>
                <span class="close" onclick="closeProductModal()">&times;</span>
            </div>
            <form id="productForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>T√™n S·∫£n Ph·∫©m:</label>
                        <input type="text" id="product-name" required>
                    </div>
                    <div class="form-group">
                        <label>Danh M·ª•c:</label>
                        <select id="product-category" required>
                            <!-- Categories will be loaded here -->
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>M√¥ T·∫£:</label>
                    <textarea id="product-description"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Gi√° B√°n (‚Ç´):</label>
                        <input type="number" id="product-price" required>
                    </div>
                    <div class="form-group">
                        <label>Gi√° G·ªëc (‚Ç´):</label>
                        <input type="number" id="product-original-price">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>S·ªë L∆∞·ª£ng:</label>
                        <input type="number" id="product-stock" required>
                    </div>
                    <div class="form-group">
                        <label>Tr·∫°ng Th√°i:</label>
                        <select id="product-status">
                            <option value="active">Ho·∫°t ƒê·ªông</option>
                            <option value="inactive">T·∫°m D·ª´ng</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Link H√¨nh ·∫¢nh:</label>
                    <input type="url" id="product-image" placeholder="https://example.com/image.jpg">
                </div>
                <button type="submit" class="btn btn-primary">üíæ L∆∞u S·∫£n Ph·∫©m</button>
            </form>
        </div>
    </div>

    <script>
        let database = {};
        let currentCategoryId = null;
        let currentProductId = null;

        // Load database
        async function loadDatabase() {
            try {
                const response = await fetch('/api/database');
                database = await response.json();
                updateDashboard();
                loadCategories();
                loadProducts();
                loadOrders();
                loadSettings();
            } catch (error) {
                console.error('Error loading database:', error);
                // Load from local file if API fails
                database = {
                    categories: [],
                    products: [],
                    orders: [],
                    settings: {
                        site_name: "MMO Services Store",
                        site_description: "C·ª≠a h√†ng d·ªãch v·ª• MMO uy t√≠n",
                        contact_email: "admin@andev.site",
                        contact_phone: "0123456789"
                    }
                };
            }
        }

        // Update dashboard stats
        function updateDashboard() {
            document.getElementById('total-products').textContent = database.products?.length || 0;
            document.getElementById('total-categories').textContent = database.categories?.length || 0;
            document.getElementById('total-orders').textContent = database.orders?.length || 0;
            
            const totalRevenue = database.orders?.reduce((sum, order) => sum + (order.total || 0), 0) || 0;
            document.getElementById('total-revenue').textContent = new Intl.NumberFormat('vi-VN').format(totalRevenue) + '‚Ç´';
        }

        // Show section
        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(el => el.style.display = 'none');
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-menu a').forEach(el => el.classList.remove('active'));
            
            // Show selected section
            document.getElementById(section + '-section').style.display = 'block';
            
            // Add active class to clicked nav item
            event.target.classList.add('active');
        }

        // Load categories
        function loadCategories() {
            const tbody = document.getElementById('categories-table');
            tbody.innerHTML = '';
            
            if (database.categories) {
                database.categories.forEach(category => {
                    const productCount = database.products?.filter(p => p.category_id === category.id).length || 0;
                    tbody.innerHTML += `
                        <tr>
                            <td>${category.id}</td>
                            <td>${category.icon} ${category.name}</td>
                            <td>${category.description}</td>
                            <td>${productCount}</td>
                            <td>
                                <button class="btn btn-warning" onclick="editCategory(${category.id})">‚úèÔ∏è</button>
                                <button class="btn btn-danger" onclick="deleteCategory(${category.id})">üóëÔ∏è</button>
                            </td>
                        </tr>
                    `;
                });
            }
        }

        // Load products
        function loadProducts() {
            const tbody = document.getElementById('products-table');
            tbody.innerHTML = '';
            
            if (database.products) {
                database.products.forEach(product => {
                    const category = database.categories?.find(c => c.id === product.category_id);
                    const statusBadge = product.status === 'active' ? 
                        '<span class="badge badge-success">Ho·∫°t ƒê·ªông</span>' : 
                        '<span class="badge badge-danger">T·∫°m D·ª´ng</span>';
                    
                    tbody.innerHTML += `
                        <tr>
                            <td>${product.id}</td>
                            <td>${product.name}</td>
                            <td>${category?.name || 'N/A'}</td>
                            <td>${new Intl.NumberFormat('vi-VN').format(product.price)}‚Ç´</td>
                            <td>${product.stock}</td>
                            <td>${statusBadge}</td>
                            <td>
                                <button class="btn btn-warning" onclick="editProduct(${product.id})">‚úèÔ∏è</button>
                                <button class="btn btn-danger" onclick="deleteProduct(${product.id})">üóëÔ∏è</button>
                            </td>
                        </tr>
                    `;
                });
            }
        }

        // Load orders
        function loadOrders() {
            const tbody = document.getElementById('orders-table');
            tbody.innerHTML = '';
            
            if (database.orders && database.orders.length > 0) {
                database.orders.forEach(order => {
                    const statusBadge = order.status === 'paid' ? 
                        '<span class="badge badge-success">ƒê√£ Thanh To√°n</span>' : 
                        '<span class="badge badge-warning">Ch·ªù Thanh To√°n</span>';
                    
                    tbody.innerHTML += `
                        <tr>
                            <td>${order.id}</td>
                            <td>${order.customer_name || 'N/A'}</td>
                            <td>${order.product_name || 'N/A'}</td>
                            <td>${new Intl.NumberFormat('vi-VN').format(order.total)}‚Ç´</td>
                            <td>${statusBadge}</td>
                            <td>${new Date(order.created_at).toLocaleDateString('vi-VN')}</td>
                            <td>
                                <button class="btn btn-primary" onclick="viewOrder('${order.id}')">üëÅÔ∏è</button>
                            </td>
                        </tr>
                    `;
                });
            } else {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center;">Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o</td></tr>';
            }
        }

        // Load settings
        function loadSettings() {
            if (database.settings) {
                document.getElementById('site-name').value = database.settings.site_name || '';
                document.getElementById('site-description').value = database.settings.site_description || '';
                document.getElementById('contact-email').value = database.settings.contact_email || '';
                document.getElementById('contact-phone').value = database.settings.contact_phone || '';
            }
        }

        // Category modal functions
        function openCategoryModal(categoryId = null) {
            currentCategoryId = categoryId;
            const modal = document.getElementById('categoryModal');
            const form = document.getElementById('categoryForm');
            
            if (categoryId) {
                const category = database.categories.find(c => c.id === categoryId);
                if (category) {
                    document.getElementById('category-name').value = category.name;
                    document.getElementById('category-description').value = category.description;
                    document.getElementById('category-icon').value = category.icon;
                }
            } else {
                form.reset();
            }
            
            modal.style.display = 'block';
        }

        function closeCategoryModal() {
            document.getElementById('categoryModal').style.display = 'none';
        }

        // Product modal functions
        function openProductModal(productId = null) {
            currentProductId = productId;
            const modal = document.getElementById('productModal');
            const form = document.getElementById('productForm');
            
            // Load categories for dropdown
            const categorySelect = document.getElementById('product-category');
            categorySelect.innerHTML = '';
            if (database.categories) {
                database.categories.forEach(category => {
                    categorySelect.innerHTML += `<option value="${category.id}">${category.icon} ${category.name}</option>`;
                });
            }
            
            if (productId) {
                const product = database.products.find(p => p.id === productId);
                if (product) {
                    document.getElementById('product-name').value = product.name;
                    document.getElementById('product-description').value = product.description;
                    document.getElementById('product-price').value = product.price;
                    document.getElementById('product-original-price').value = product.original_price || '';
                    document.getElementById('product-stock').value = product.stock;
                    document.getElementById('product-status').value = product.status;
                    document.getElementById('product-category').value = product.category_id;
                    document.getElementById('product-image').value = product.image || '';
                }
            } else {
                form.reset();
            }
            
            modal.style.display = 'block';
        }

        function closeProductModal() {
            document.getElementById('productModal').style.display = 'none';
        }

        // Form submissions
        document.getElementById('categoryForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveCategory();
        });

        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            saveProduct();
        });

        // Save category
        function saveCategory() {
            const name = document.getElementById('category-name').value;
            const description = document.getElementById('category-description').value;
            const icon = document.getElementById('category-icon').value;

            if (currentCategoryId) {
                // Update existing category
                const category = database.categories.find(c => c.id === currentCategoryId);
                if (category) {
                    category.name = name;
                    category.description = description;
                    category.icon = icon;
                }
            } else {
                // Add new category
                const newCategory = {
                    id: Date.now(),
                    name: name,
                    description: description,
                    icon: icon,
                    created_at: new Date().toISOString()
                };
                database.categories.push(newCategory);
            }

            saveDatabase();
            loadCategories();
            closeCategoryModal();
        }

        // Save product
        function saveProduct() {
            const name = document.getElementById('product-name').value;
            const description = document.getElementById('product-description').value;
            const price = parseInt(document.getElementById('product-price').value);
            const originalPrice = parseInt(document.getElementById('product-original-price').value) || price;
            const stock = parseInt(document.getElementById('product-stock').value);
            const status = document.getElementById('product-status').value;
            const categoryId = parseInt(document.getElementById('product-category').value);
            const image = document.getElementById('product-image').value;

            if (currentProductId) {
                // Update existing product
                const product = database.products.find(p => p.id === currentProductId);
                if (product) {
                    product.name = name;
                    product.description = description;
                    product.price = price;
                    product.original_price = originalPrice;
                    product.stock = stock;
                    product.status = status;
                    product.category_id = categoryId;
                    product.image = image;
                }
            } else {
                // Add new product
                const newProduct = {
                    id: Date.now(),
                    category_id: categoryId,
                    name: name,
                    description: description,
                    price: price,
                    original_price: originalPrice,
                    stock: stock,
                    image: image,
                    status: status,
                    created_at: new Date().toISOString()
                };
                database.products.push(newProduct);
            }

            saveDatabase();
            loadProducts();
            closeProductModal();
        }

        // Save settings
        function saveSettings() {
            database.settings = {
                site_name: document.getElementById('site-name').value,
                site_description: document.getElementById('site-description').value,
                contact_email: document.getElementById('contact-email').value,
                contact_phone: document.getElementById('contact-phone').value,
                payment_config: database.settings?.payment_config || {}
            };

            saveDatabase();
            alert('‚úÖ C√†i ƒë·∫∑t ƒë√£ ƒë∆∞·ª£c l∆∞u!');
        }

        // Save database
        async function saveDatabase() {
            try {
                await fetch('/api/database', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(database)
                });
            } catch (error) {
                console.error('Error saving database:', error);
            }
        }

        // Edit functions
        function editCategory(id) {
            openCategoryModal(id);
        }

        function editProduct(id) {
            openProductModal(id);
        }

        // Delete functions
        function deleteCategory(id) {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a danh m·ª•c n√†y?')) {
                database.categories = database.categories.filter(c => c.id !== id);
                saveDatabase();
                loadCategories();
            }
        }

        function deleteProduct(id) {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m n√†y?')) {
                database.products = database.products.filter(p => p.id !== id);
                saveDatabase();
                loadProducts();
            }
        }

        // View order
        function viewOrder(id) {
            const order = database.orders.find(o => o.id === id);
            if (order) {
                alert(`ƒê∆°n h√†ng: ${order.id}\nKh√°ch h√†ng: ${order.customer_name}\nS·∫£n ph·∫©m: ${order.product_name}\nT·ªïng ti·ªÅn: ${new Intl.NumberFormat('vi-VN').format(order.total)}‚Ç´\nTr·∫°ng th√°i: ${order.status}`);
            }
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const categoryModal = document.getElementById('categoryModal');
            const productModal = document.getElementById('productModal');
            
            if (event.target === categoryModal) {
                closeCategoryModal();
            }
            if (event.target === productModal) {
                closeProductModal();
            }
        }

        // Initialize
        window.addEventListener('load', loadDatabase);
    </script>
</body>
</html>